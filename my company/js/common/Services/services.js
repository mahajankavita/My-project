var app=angular.module("App");app.service("CommonService",function($location,$filter,$http,globals,$rootScope){var CommonService={};CommonService.formatReg=function(registrationNo){var regNo=registrationNo;regNo=regNo.replace(/-/g,"");var regNoArray=new Array(4);regNoArray[0]=regNo.slice(0,2);regNoArray[1]="";regNoArray[2]="";regNoArray[3]="";try{if(!isNaN(regNo.slice(2,4))){regNoArray[1]=regNo.slice(2,4);}else{if(!isNaN(regNo.slice(2,3))){regNoArray[1]=regNo.slice(2,3);}
if(isNaN(regNo.slice(3,4))){regNoArray[2]=regNo.slice(3,4);}}
if(!isNaN(regNo.slice(4,8))){regNoArray[3]=regNoArray[3]+regNo.slice(4,8);}else{regNoArray[2]=regNoArray[2]+regNo.slice(4,5);if(isNaN(regNo.slice(5,6))==true&&isNaN(regNo.slice(6,7))==true){regNoArray[2]=regNoArray[2]+regNo.slice(5,7);}else{if(isNaN(regNo.slice(5,6))){regNoArray[2]=regNoArray[2]+regNo.slice(5,6);}else{regNoArray[3]=regNoArray[3]+regNo.slice(5,6);}
if(!isNaN(regNo.slice(6,7))){regNoArray[3]=regNoArray[3]+regNo.slice(6,7);}}
if(!isNaN(regNo.slice(7,11))){regNoArray[3]=regNoArray[3]+regNo.slice(7,11);}}}catch(e){}
return regNoArray.join("-").replace(/--/g,"-").replace(/-\s*$/,"").replace(/[^- 0-9 a-z A-z]/g,"");};CommonService.insurancecompanies=function(data){var request=$http({method:"POST",url:globals.IGwServiceURL+"/IGGeneralServices.svc/web/GetInsurer",headers:{"Content-Type":"application/json; charset=utf-8"},dataType:"json",data:JSON.stringify({RequestString:data}),});return request;};CommonService.insurancecompaniesbyproduct=function(data){var request=$http({method:"POST",url:globals.IGwServiceURL+"/CommonService.svc/web/GetInsurerListByProductId",headers:{"Content-Type":"application/json; charset=utf-8"},dataType:"json",data:JSON.stringify(data),});return request;};CommonService.citylist=function($scope){var vData={IsTopLocation:$scope.CityValue};var request=$http({method:"POST",dataType:"json",url:globals.ServiceURL+"/MasterService.svc/web/GetCityList",contentType:"application/json; charset=utf-8",data:JSON.stringify(vData)});return request;};CommonService.getCountrylist=function(){var request=$http({method:"POST",url:globals.ServiceURL+"/MasterService.svc/web/GetCountryList"});return request;};CommonService.revisit=function($scope,globals,cpid){var vData={Request:cpid};var request=$http({method:"POST",dataType:"json",url:globals.ServiceURL+"/Lead.svc/web/UpdateLeadRemarks",contentType:"application/json; charset=utf-8",data:cpid});return request;};CommonService.bikemakemodelservice=function($scope){var request=$http({method:"post",url:globals.ServiceURL+"/MasterService.svc/web/GetTWModelList",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({Combination:""})});return request;};CommonService.bikertoservice=function(data,rtocode,$scope){var request=$http({method:"POST",url:globals.ServiceURL+"/MasterService.svc/web/GetTWRTOList",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({Combination:data,FLADRtoata:rtocode}),});return request;};CommonService.carupdatedmakemodelservice=function($scope){var request=$http({method:"POST",url:globals.ServiceURL+"/MasterService.svc/web/GetCarModelList",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({Combination:""})});return request;};CommonService.carupdatedrtoservice=function($scope){var request=$http({method:"POST",url:globals.ServiceURL+"/MasterService.svc/web/GetCarRTOList",contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify({Combination:""})});return request;};CommonService.getDataByMobile=function(mobilenumber){var requestdata={MobileNumber:mobilenumber};var request=$http({method:"POST",url:globals.ServiceURL+"/Lead.svc/web/GetLeadByMobileNumber",data:JSON.stringify(requestdata)});return request;};CommonService.getDataByMobileNEW=function(mobilenumber){var requestdata={mobile:null,browserId:mobilenumber,max:10};var request=$http({method:"POST",url:globals.ServiceURL+"/Lead.svc/web/GetLeadByMobileNumberReboot",data:JSON.stringify(requestdata)});return request;};CommonService.senddownloadapplink=function(mobilenumber,msg){var vData={sendToPhoneNumber:mobilenumber,Message:msg};var request=$http({method:"POST",dataType:"jsonp",url:globals.ServiceURL+"/CommonService.svc/web/SendMessage",data:JSON.stringify(vData)});return request;};CommonService.SendOTPReboot=function($scope){var mbl=$scope.usermobile;var vData={IsResend:$scope.resendFlag,MobileNumber:mbl,CP_ID:$scope.IGQuoteId,ClientKey:$scope.encryptedData($scope.IGQuoteId.toString()+mbl)};var request=$http({method:"POST",dataType:"json",url:globals.ServiceURL+"/Lead.svc/web/SendOTPReboot",contentType:"application/json; charset=utf-8",data:JSON.stringify(vData)});return request;};CommonService.NewSendOTPReboot=function($scope,mbl,resend){var IsResend=false;if(resend==true){IsResend=true;}
var vData={IsResend:IsResend,MobileNumber:mbl,ForceOTP:true,ClientKey:$scope.encryptedData(mbl)};var request=$http({method:"POST",dataType:"json",url:globals.ServiceURL+"/Lead.svc/web/SendOTPReboot",contentType:"application/json; charset=utf-8",data:JSON.stringify(vData)});return request;};CommonService.getDataByUserVisits=function(otp,mobilenumber,Tokenid){var requestdata={request:{OTP:otp,MobileNumber:mobilenumber,Tokenid:Tokenid}};var request=$http({method:"POST",url:globals.ServiceURL+"/Lead.svc/web/GetUserVisits",data:JSON.stringify(requestdata)});return request;};CommonService.GetMobileVerificationWithOTPRequest1=function(data){var requestdata={RequestString:JSON.stringify(data.RequestString,null,"    ")};var request=$http({method:"POST",dataType:"jsonp",url:globals.IGwServiceURL+"/Lead.svc/web/GetLeadCreateRequest",data:JSON.stringify(requestdata)});return request;};CommonService.GetMobileVerificationWithOTPRequest2=function(data){var requestdata={RequestString:JSON.stringify(data.RequestString,null,"    ")};var request=$http({method:"POST",dataType:"jsonp",url:globals.IGwServiceURL+"/Lead.svc/web/GetOTPVerificationRequest",data:JSON.stringify(requestdata)});return request;};CommonService.fastlane=function(data,$scope){var requestdata={inputString:data};var request=$http({method:"POST",url:globals.IGwServiceURL+"/InsureJoyProposal.svc/web/GetVehicleLookup",contentType:"application/json",dataType:"json",data:'"'+data+'"'});return request;};CommonService.fastlane1=function(data,$scope){var requestdata={inputString:data};var request=$http({method:"POST",url:globals.IGwServiceURL+"/InsureJoyProposal.svc/web/GetVehicleLookupWithlead",contentType:"application/json",dataType:"json",data:JSON.stringify(data)});return request;};CommonService.sethelpdeskticket=function(data){var request=$http({method:"POST",url:globals.fershDeskURL,headers:{Authorization:"Basic "+btoa("Hiw8F38wrT1enWBFRz"+":x")},contentType:"application/json",dataType:"json",data:JSON.stringify(data)});return request;};CommonService.helpdeskticketlist=function(userEmail){var request=$http({method:"GET",url:"https://insurejoy.freshdesk.com/api/v2/tickets?email="+userEmail,headers:{Authorization:"Basic "+btoa("67PZTI5zoRxGMNT3H4HW"+":x")},contentType:"application/json",dataType:"json",});return request;};CommonService.helpdeskticketview=function(id){var request=$http({method:"GET",url:"https://insurejoy.freshdesk.com/api/v2/tickets/"+id,headers:{Authorization:"Basic "+btoa("67PZTI5zoRxGMNT3H4HW"+":x")},contentType:"application/json",dataType:"json"});return request;};CommonService.saveCarRequirementData=function($scope,globals){if($scope.carbreaking==0&&$scope.carbreakingexp==1){var breaking=91;}else if($scope.carbreaking==0&&$scope.carbreakingexp==0){var breaking=90;}else{var breaking=0;}
if($scope.carkitstatus=="Kit3"){var cng="External";}else if($scope.carkitstatus=="Kit2"){var cng="Internal";$scope.$root.entercngkitvalue=0;}else if($scope.carkitstatus=="Kit1"){var cng="None";$scope.$root.entercngkitvalue=0;}
if($scope.newcarSearch==true){var IsNewVehicle=true;}else{var IsNewVehicle=false;}
var requestdata={IGQuoteId:$scope.VechileLookUpLeadIdCar,IsDnc:true,IsWhatsappAllowed:$scope.isWhatsApp,PartnerAgentId:$scope.utmpartneragentiddata,PartnerLeadId:$scope.utmpartnerleadiddata,RequestType:"",DeviceType:$scope.apidevice,MobileNo:$scope.usermobile,DeviceName:$scope.apios,Browser:$scope.apiBrowser,IPAddress:"1.1.1.1",LandingURL:globals.landingPage,Requests:[{__type:"CarRequest:#ServiceEntities",ProductId:4,BreakingDays:breaking,ClaimTaken:$scope.ClaimTaken,ClaimedNCB:$scope.carclaimedncb,RequiredNCB:$scope.carrequiredncb,IDV:0,InsurerIds:[1,17],IsNewVehicle:IsNewVehicle,ModelId:$scope.selectedItem.ModelId,RTOCode:$scope.selectedItem1.RTOCode,KitValue:$scope.$root.entercngkitvalue,RegistrationYear:$scope.carreg,RegistrationDate:$scope.Registrationdate,RegistrationNo:$scope.carregnumber,ChasisNo:$scope.carchasisno==undefined?"":$scope.carchasisno,EngineNo:$scope.carengineno==undefined?"":$scope.carengineno,Features:[{__type:"BooleanFeature:#ServiceEntities",Name:"ZeroDept",IsSelected:false},{__type:"BooleanFeature:#ServiceEntities",Name:"RSAC",IsSelected:false},{__type:"BooleanFeature:#ServiceEntities",Name:"NCBProtection",IsSelected:false},{__type:"BooleanFeature:#ServiceEntities",Name:"Invoice",IsSelected:false},{__type:"BooleanFeature:#ServiceEntities",Name:"Enginegear",IsSelected:false},{__type:"BooleanFeature:#ServiceEntities",Name:"KeyLockReplacement",IsSelected:false},{__type:"BooleanFeature:#ServiceEntities",Name:"HydrostaticLock",IsSelected:false},{__type:"BooleanFeature:#ServiceEntities",Name:"Hospital",IsSelected:false},{__type:"BooleanFeature:#ServiceEntities",Name:"Medical",IsSelected:false},{__type:"BooleanFeature:#ServiceEntities",Name:"CashAllowance",IsSelected:false},{__type:"BooleanFeature:#ServiceEntities",Name:"TyreCover",IsSelected:false},{__type:"BooleanFeature:#ServiceEntities",Name:"CostOfConsumables",IsSelected:false},{__type:"BooleanFeature:#ServiceEntities",Name:"AntiTheftDevice",IsSelected:false},{__type:"BooleanFeature:#ServiceEntities",Name:"LegalLiabilityPaidDriver",IsSelected:false},{__type:"CustomFeature:#ServiceEntities",Name:"PAUnnamed",Value:0,IsSelected:false},{__type:"CustomFeature:#ServiceEntities",Name:"LegalLiabilityPaidDriverSI",Value:0,IsSelected:false},{__type:"CustomFeature:#ServiceEntities",Name:"VoluntryDiscount",Value:0,IsSelected:false},{__type:"CustomFeature:#ServiceEntities",Name:"ElectricalAccessory",Value:0,IsSelected:false},{__type:"CustomFeature:#ServiceEntities",Name:"NonElectricalAccessory",Value:0,IsSelected:false},{__type:"CNGFeature:#ServiceEntities",Name:"CNG",Type:cng,Value:$scope.$root.entercngkitvalue},{__type:"AAIFeature:#ServiceEntities",Name:"AAI",LicenseNumber:"6324523vsadfa",AssociateName:"mangal deep gupta",ExpiryDate:JSON.parse(CommonService.stringifyWcf("12-12-2017",1)),IsLifeMember:true,IsSelected:false,},],},],ServiceTimeOut:11,utmCompaign:$scope.utmcampaigndata,utmSource:$scope.utmsourcedata,utmMedium:$scope.utmmediumdata,utmTerm:$scope.utmtermdata,};var request=$http({method:"POST",dataType:"jsonp",url:globals.ServiceURL+"/QuoteService.svc/web/Save",data:requestdata});return request;};CommonService.saveBikeRequirementData=function($scope){if($scope.newcarSearch==true){var IsNewVehicle=true;}else{var IsNewVehicle=false;}
var requestdata={IGQuoteId:$scope.VechileLookUpLeadIdBike,IsDnc:true,IsWhatsappAllowed:$scope.isWhatsApp,MobileNo:$scope.usermobile,IsOffline:true,PartnerAgentId:$scope.utmpartneragentiddata,PartnerLeadId:$scope.utmpartnerleadiddata,RequestType:"",IPAddress:"1.1.1.1",DeviceType:$scope.apidevice,DeviceName:$scope.apios,Browser:$scope.apiBrowser,LandingURL:globals.landingPage,Requests:[{__type:"TWRequest:#ServiceEntities",ProductId:8,BreakingDays:$scope.bikeexpiredpol,ClaimTaken:$scope.ClaimTaken,ClaimedNCB:$scope.ClaimedNCB,RequiredNCB:$scope.RequiredNCB,IDV:0,InsurerIds:[1,17],IsNewVehicle:IsNewVehicle,ModelId:$scope.selectedbikemmv.modelid,RTOCode:$scope.selectedbikerto.RTOCode,RegistrationYear:$scope.bikereg,RegistrationNo:$scope.bikeregnumber,ChasisNo:$scope.bikechasisno==undefined?"":$scope.bikechasisno,EngineNo:$scope.bikeengineno==undefined?"":$scope.bikeengineno,RegistrationDate:$scope.Registrationdate,Features:[{__type:"BooleanFeature:#ServiceEntities",Name:"ZeroDept",IsSelected:false},{__type:"BooleanFeature:#ServiceEntities",Name:"RSAC",IsSelected:false},{__type:"CustomFeature:#ServiceEntities",Name:"PAUnnamed",Value:0},],},],ServiceTimeOut:11,utmMedium:$scope.utmmediumdata,utmCompaign:$scope.utmcampaigndata,utmSource:$scope.utmsourcedata,utmTerm:$scope.utmtermdata,};var request=$http({method:"POST",dataType:"jsonp",url:globals.ServiceURL+"/QuoteService.svc/web/Save",data:requestdata});return request;};CommonService.saveHealthRequirementData=function($scope,globals){if($scope.isSuperTopup){$scope.utmsourcedata="crossSell";$scope.utmcampaigndata="direct";}
var requestdata={IGQuoteId:0,IsDnc:true,IsWhatsappAllowed:$scope.isWhatsApp,PartnerAgentId:$scope.utmpartneragentiddata,PartnerLeadId:$scope.utmpartnerleadiddata,RequestType:"",MobileNo:$scope.usermobile,DeviceType:$scope.apidevice,DeviceName:$scope.apios,Browser:$scope.apiBrowser,IPAddress:"1.1.1.1",LandingURL:globals.landingPage,Requests:[{__type:"HealthRequest:#ServiceEntities",Features:[],ProductId:2,IsOffline:true,CityId:parseInt($scope.selectedItem2.cityid.split(",")[0].trim()),DOB:JSON.parse(CommonService.stringifyWcf($scope.formdob,1)),Gender:$scope.gender,InsurerIds:"",IsQuotes:"",NetworkHospital1:null,NetworkHospital2:null,NetworkHospital3:null,NumberOfAdults:parseInt($scope.selectedadult),NumberOfChildren:parseInt($scope.selectedchild),PolicyTerm:1,SumInsured:550000,Medicaltest:0,DiseasID:"",FeatureID:"",HospitalID:"",IGQuoteId:0,DeductibleAmount:$scope.preIGPolicyCover,},],ServiceTimeOut:123,utmMedium:$scope.utmmediumdata,utmCompaign:$scope.utmcampaigndata,utmSource:$scope.utmsourcedata,utmTerm:$scope.utm_term,};var request=$http({method:"POST",dataType:"jsonp",url:globals.ServiceURL+"/QuoteService.svc/web/Save",data:requestdata});return request;};CommonService.saveCovidRequirementData=function($scope,globals){var requestdata={IGQuoteId:0,IsDnc:true,PartnerAgentId:$scope.utmpartneragentiddata,PartnerLeadId:$scope.utmpartnerleadiddata,RequestType:"",MobileNo:$scope.usermobile,DeviceType:$scope.apidevice,DeviceName:$scope.apios,Browser:$scope.apiBrowser,IPAddress:"1.1.1.1",LandingURL:globals.landingPage,Requests:[{__type:"HealthRequest:#ServiceEntities",IsCovid:true,Features:[],ProductId:2,IsOffline:true,CityId:parseInt($scope.selectedItem2.cityid.split(",")[0].trim()),DOB:JSON.parse(CommonService.stringifyWcf($scope.formdob,1)),Gender:$scope.gender,InsurerIds:"",IsQuotes:"",NetworkHospital1:null,NetworkHospital2:null,NetworkHospital3:null,NumberOfAdults:parseInt($scope.selectedadult),NumberOfChildren:parseInt($scope.selectedchild),PolicyTermDays:105,SumInsured:100000,Medicaltest:0,DiseasID:"",FeatureID:"",HospitalID:"",IGQuoteId:0,},],ServiceTimeOut:123,utmMedium:$scope.utmmediumdata,utmCompaign:$scope.utmcampaigndata,utmSource:$scope.utmsourcedata,utmTerm:$scope.utm_term,};var request=$http({method:"POST",dataType:"jsonp",url:globals.ServiceURL+"/QuoteService.svc/web/Save",data:requestdata});return request;};CommonService.saveCriticalRequirementData=function($scope,globals){var SumAssured=Math.round((parseInt($scope.txtActualIncome.value)*12)/100000)*100000;if(SumAssured>5000000){SumAssured=5000000;}
var requestdata={IGQuoteId:0,IsWhatsappAllowed:$scope.isWhatsApp,PartnerAgentId:$scope.utmpartneragentiddata,MobileNo:$scope.usermobile,PartnerLeadId:$scope.utmpartnerleadiddata,RequestType:"",Requests:[{__type:"CancerRequest:#ServiceEntities",ProductId:9,IsOffline:true,DeviceType:$scope.apidevice,DeviceName:$scope.apios,Browser:$scope.apiBrowser,CityID:parseInt($scope.selectedItem2.cityid.split(",")[0].trim()),DateOfBirth:JSON.parse(CommonService.stringifyWcf($scope.formdob,1)),Gender:$scope.gender,IsTobacco:$scope.formtobacco.toLowerCase(),PolicyTerm:0,SumAssured:SumAssured,UserInputIncome:parseInt($scope.txtActualIncome.value),},],ServiceTimeOut:0,utmMedium:$scope.utmmediumdata,utmCompaign:$scope.utmcampaigndata,utmSource:$scope.utmsourcedata,utmTerm:"",};var request=$http({method:"POST",dataType:"jsonp",url:globals.ServiceURL+"/QuoteService.svc/web/Save",data:requestdata});return request;};CommonService.saveTermRequirementData=function($scope,globals){var requestdata={IGQuoteId:0,IsDnc:true,IsWhatsappAllowed:$scope.isWhatsApp,PartnerAgentId:$scope.utmpartneragentiddata,MobileNo:$scope.usermobile,PartnerLeadId:$scope.utmpartnerleadiddata,RequestType:"",IPAddress:"1.1.1.1",DeviceType:$scope.apidevice,DeviceName:$scope.apios,Browser:$scope.apiBrowser,LandingURL:globals.landingPage,Requests:[{__type:"TermRequest:#ServiceEntities",Features:null,ProductId:3,IsOffline:true,AnnualIncomeRange:$scope.txtActualIncome.value,CityID:parseInt($scope.selectedItem2.cityid.split(",")[0].trim()),DateOfBirth:JSON.parse(CommonService.stringifyWcf($scope.formdob,1)),Gender:$scope.gender,IsTobacco:$scope.formtobacco.toLowerCase(),PayingMode:"Yearly",PolicyTerm:$scope.PolicyTerm,SelectedRiders:[],SumAssured:$scope.SumAssured,UserInputIncome:parseInt($scope.txtActualIncome.value),MinAnnualIncomeRange:parseInt($scope.minincome),MaxAnnualIncomeRange:parseInt($scope.maxincome),},],ServiceTimeOut:0,utmMedium:$scope.utmmediumdata,utmCompaign:$scope.utmcampaigndata,utmSource:$scope.utmsourcedata,utmTerm:"",};var request=$http({method:"POST",dataType:"jsonp",url:globals.ServiceURL+"/QuoteService.svc/web/Save",data:requestdata});return request;};CommonService.saveInvestmentRequirementData=function($scope,globals){var requestdata={IGQuoteId:0,IsDnc:true,IsWhatsappAllowed:$scope.isWhatsApp,DeviceType:$scope.apidevice,MobileNo:$scope.usermobile,DeviceName:$scope.apios,Browser:$scope.apiBrowser,PartnerAgentId:$scope.utmpartneragentiddata,PartnerLeadId:$scope.utmpartnerleadiddata,RequestType:"",LandingURL:globals.landingPage,Requests:[{__type:"NonTermRequest:#ServiceEntities",DOBs:[JSON.parse(CommonService.stringifyWcf($scope.formdob,1))],Features:[{__type:"BooleanFeature:#ServiceEntities",Id:"0",Name:""},{__type:"CustomFeature:#ServiceEntities",Name:"",Id:"0"},{__type:"CustomFeature:#ServiceEntities",Id:"0",Name:""},{__type:"CustomFeature:#ServiceEntities",Id:"0",Name:""},{__type:"CustomFeature:#ServiceEntities",Id:"0",Name:""},],Amount:$scope.txtInvestIncome,PayingMode:$scope.selectedincome,MaturityTerm:10,MaxMaturityTerm:10,Gender:$scope.formgender,IsTobacco:$scope.formtobacco.toLowerCase(),CityId:3035,MinRisk:0,MaxRisk:0,ProductId:5,MaturityType:"HistoricalGrowth",PaymentDuration:10,},],ServiceTimeOut:"2147483647",utmMedium:$scope.utmmediumdata,utmCompaign:$scope.utmcampaigndata,utmSource:$scope.utmsourcedata,utmTerm:$scope.UtmTerm,};var request=$http({method:"POST",dataType:"jsonp",url:globals.ServiceURL+"/QuoteService.svc/web/Save",data:requestdata});return request;};CommonService.savePensionRequirementData=function($scope,globals){var requestdata={IGQuoteId:0,IsDnc:true,IsWhatsappAllowed:$scope.isWhatsApp,DeviceType:$scope.apidevice,MobileNo:$scope.usermobile,DeviceName:$scope.apios,Browser:$scope.apiBrowser,PartnerAgentId:$scope.utmpartneragentiddata,PartnerLeadId:$scope.utmpartnerleadiddata,RequestType:"String content",LandingURL:globals.landingPage,Requests:[{__type:"NonTermRequest:#ServiceEntities",DOBs:[JSON.parse(CommonService.stringifyWcf($scope.formdob,1))],Features:[{__type:"BooleanFeature:#ServiceEntities",Name:"",Id:0}],Amount:$scope.txtPensionIncome,PayingMode:$scope.payMode,MaturityTerm:"24",Gender:$scope.formgender,CityId:3035,PensionFor:"self",ProductId:6,MinRisk:0,MaxRisk:0,PaymentDuration:24,PensionTill:90,},],ServiceTimeOut:2147483647,utmMedium:$scope.utmmediumdata,utmCompaign:$scope.utmcampaigndata,utmSource:$scope.utmsourcedata,utmTerm:$scope.UtmTerm,};var request=$http({method:"POST",dataType:"jsonp",url:globals.ServiceURL+"/QuoteService.svc/web/Save",data:requestdata});return request;};CommonService.saveChildRequirementData=function($scope,globals){var requestdata={IGQuoteId:0,IsDnc:true,IsWhatsappAllowed:$scope.isWhatsApp,DeviceType:$scope.apidevice,MobileNo:$scope.usermobile,DeviceName:$scope.apios,Browser:$scope.apiBrowser,PartnerAgentId:$scope.utmpartneragentiddata,PartnerLeadId:$scope.utmpartnerleadiddata,RequestType:"",LandingURL:globals.landingPage,Requests:[{__type:"NonTermRequest:#ServiceEntities",DOBs:[JSON.parse(CommonService.stringifyWcf($scope.formdob,1)),JSON.parse(CommonService.stringifyWcf($scope.childDOB,1))],Features:[{__type:"BooleanFeature:#ServiceEntities",Id:"0",Name:""},{__type:"BooleanFeature:#ServiceEntities",Id:"0",Name:""},],Amount:$scope.childincome,PayingMode:$scope.childincometype,MaturityTerm:10,MaxMaturityTerm:10,Gender:$scope.formgender,CityId:3035,MinRisk:1,MaxRisk:5,ProductId:7,MaturityType:"HistoricalGrowth",PaymentDuration:10,},],ServiceTimeOut:"2147483647",utmMedium:$scope.utmmediumdata,utmCompaign:$scope.utmcampaigndata,utmSource:$scope.utmsourcedata,utmTerm:$scope.UtmTerm,};$scope.timeoutarray["saveservice"]=new Date().getTime();var request=$http({method:"POST",dataType:"jsonp",url:globals.ServiceURL+"/QuoteService.svc/web/Save",data:requestdata});return request;};CommonService.UpdateVahicleLookup=function($scope){var requestdata={UniqueId:$scope.UniqueId,MakeModelIds:$scope.fastlanedata.MakeModelIds,MakeModel:$scope.fastlanedata.MakeModel,ProductType:$scope.ProductType,RegistrationNo:$scope.fastlanedata.RegistrationNumber,ChassisNo:$scope.fastlanedata.ChassisNumber,EngineNo:$scope.fastlanedata.EngineNumber,ManufactureYear:$scope.fastlanedata.ManufactureYear,VehicleOwner:$scope.fastlanedata.VehicleOwner==null?"":$scope.fastlanedata.VehicleOwner,IPAddress:$scope.ip,};var request=$http({method:"POST",url:globals.IGwServiceURL+"/InsureJoyProposal.svc/web/UpdateVehicleLookup",contentType:"application/json",dataType:"json",data:requestdata});return request;};CommonService.saveTravelRequirementData=function($scope,globals){if($scope.formtraveldestinations)
var requestdata={IGQuoteId:0,IsDnc:true,DeviceType:$scope.apidevice,MobileNo:$scope.usermobile,DeviceName:$scope.apios,Browser:$scope.apiBrowser,PartnerAgentId:$scope.utmpartneragentiddata,PartnerLeadId:$scope.utmpartnerleadiddata,RequestType:"",LandingURL:globals.landingPage,Requests:[{__type:"TravelRequest:#ServiceEntities",Features:[],ProductId:1,CityId:3035,DOBs:$scope.DOBArray,Destinations:$scope.formtraveldestinations.toString().split(","),EndDate:JSON.parse(CommonService.stringifyWcf($scope.formtravelenddate,3)),PolicyType:1,StartDate:JSON.parse(CommonService.stringifyWcf($scope.formtravelstartdate,3)),SumInsured:50000,TripType:1,},],utmMedium:$scope.utmmediumdata,utmCompaign:$scope.utmcampaigndata,utmSource:$scope.utmsourcedata,utmTerm:$scope.utm_term,};$scope.timeoutarray["saveservice"]=new Date().getTime();var request=$http({method:"POST",dataType:"jsonp",url:globals.ServiceURL+"/QuoteService.svc/web/Save",data:requestdata});return request;};CommonService.TimeOutProposalService=function(IGquoteId,product,browser,os,urlservice,Threshold,IP,ServiceName,device,timetaken){var data={request:{CPID:IGquoteId,TimeOutUrl:urlservice,Browser:browser,ServiceName:ServiceName,Threshold:Threshold,Carrier:"",DeviceType:device,Location:IP,OS:os,ProductName:product}};if(timetaken!=undefined){data.request.TimeDuration=timetaken;}
var request=$http({method:"POST",dataType:"jsonp",url:globals.ServiceURL+"/CommonService.svc/web/GetTimeOutUrl",data:data});return request;};CommonService.GetPincodeList=function(cityid){var vData={citypin:{CityId:cityid}};var request=$http({method:"POST",dataType:"json",url:globals.ServiceURL+"/CommonService.svc/web/GetCityBasisPinCode",contentType:"application/json; charset=utf-8",data:JSON.stringify(vData)});return request;};CommonService.SaveUserProfileDetails=function($scope,date,cityid,income,mobile){if($scope.MaritalStatus=="Single"){$scope.NoOfChild=0;}
var data={request:{Name:$scope.UserName,EmailId:$scope.EmailId,DOB:date,Gender:$scope.gender,MaritalStatus:$scope.MaritalStatus,Qualification:$scope.Qualification,Income:income,City:cityid,Pincode:$scope.PinCode,NoOfChild:$scope.NoOfChild,MobileNo:mobile,Profession:$scope.Profession,},};var request=$http({method:"POST",dataType:"jsonp",url:globals.ServiceURL+"/MetaDataService.svc/web/SaveUserProfileDetails",data:data});return request;};CommonService.GetUserProfileDetails=function(getmobilenumber){var data={request:{MobileNo:getmobilenumber}};var request=$http({method:"POST",dataType:"jsonp",url:globals.ServiceURL+"/MetaDataService.svc/web/GetUserProfileDetails",data:data});return request;};CommonService.UserActivityWithPolicyDetails=function(getmobilenumber){var data={request:{MobileNo:getmobilenumber}};var request=$http({method:"POST",dataType:"jsonp",url:globals.ServiceURL+"/MetaDataService.svc/web/UserActivityWithPolicyDetails",data:data});return request;};CommonService.SendReferralServiceMails=function($scope){var vURL=globals.ServiceURL+"/CommonService.svc/web/sendservicemail";var vData={MailTo:$scope.ReferralEmail,MailFrom:$scope.EmailId,MailSubject:$scope.ReferralMailSubject,MailContent:$scope.MailContent};var request=$http({method:"POST",url:vURL,data:JSON.stringify(vData)});return request;};CommonService.stringifyWcf=function(json,flag){var reISO=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/;var reMsAjax=/^\/Date\((d|-|.*)\)[\/|\\]$/;return JSON.stringify(json,function(key,value1){if(typeof value1=="string"){if(flag==1){value=value1.split("-")[1]+"-"+value1.split("-")[0]+"-"+value1.split("-")[2];}else if(flag==3){value=value1.split("/")[0]+"-"+value1.split("/")[1]+"-"+value1.split("/")[2];}else{value=value1.split("-")[1]+"-"+value1.split("-")[0]+"-"+value1.split("-")[2];}
value1=new Date(value);if(isNaN(Date.parse(value1))){var splitdata=value.split('-');value=new Date(splitdata[2],splitdata[0]-1,(splitdata[1]));}
else{value=new Date(value)}
value=value.setDate(value.getDate()+1);var s=JSON.parse(JSON.stringify(new Date(value)));var a=reISO.exec(s);if(a){var val='/Date('+new Date(Date.UTC(+a[1],+a[2]-1,+a[3],+a[4],+a[5],+a[6])).getTime()+')/';this[key]=val;return val;}}
return value;})};CommonService.Claim=function($scope){var data={"ClientKey":$scope.encryptedData($scope.userNumber),"CustomerName":$scope.userName,"Descriptions":$scope.description,"EmailId":$scope.userEmail,"InsurerId":$scope.insuranceCompany.Insurer_ID,"MobileNumber":$scope.userNumber,"PolicyNo":$scope.claimPolicyNo,"ProductId":$scope.productType}
var request=$http({method:"POST",dataType:"jsonp",url:globals.ServiceURL+"/IGGeneralServices.svc/web/RegistrationClaim",data:data});return request;};CommonService.CurrentDateTime=function(){var request=$http({method:"POST",dataType:"jsonp",url:globals.ServiceURL+"/CommonService.svc/web/GetCurrentDateTime"});return request;};CommonService.GetRenewalPolicyBasicDetail=function(policyno,productid,insurerid){var requestdata={"PolicyNumber":policyno,"ProductID":productid,"Utm_Source":"direct","InsurerID":insurerid};var request=$http({method:"POST",url:globals.ServiceURL+"/QuoteService.svc/web/GetRenewalPolicyBasicDetail",data:requestdata});return request;};return CommonService;});